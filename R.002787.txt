R.002787

----------

Name: TEST 1 for LVPL
Created by: George H Williams

----------

Group: Administrative Reports
     Reports Testing Ground

Created on: 2016-10-06 14:21:56
Modified on: 2016-10-06 16:18:18
Date last run: -

----------

Public: 0
Expiry: 0

----------



----------

SELECT
     CHECK_OUT_BRANCH,
     ITEM_HOMEBRANCH,
     SHELVING_LOCATION,
     SUM(ISSUES_RENEWALS) AS CHECKOUTS_PLUS_RENEWALS

  FROM
     (SELECT statistics.branch AS CHECK_OUT_BRANCH,
          items.homebranch AS ITEM_HOMEBRANCH,
          items.location AS SHELVING_LOCATION,
          Count(*) AS ISSUES_RENEWALS
       FROM items JOIN statistics ON items.itemnumber = statistics.itemnumber
       WHERE (statistics.datetime BETWEEN (@stDate:=<<Start date|date>> COLLATE utf8_unicode_ci) AND (@edDate:=<<End date|date>> COLLATE utf8_unicode_ci))
          AND (statistics.type="issue" OR statistics.type="renew")
          AND (statistics.branch LIKE @brn:=<<Enter your branch|LBRANCH>> COLLATE utf8_unicode_ci)
       GROUP BY CHECK_OUT_BRANCH, ITEM_HOMEBRANCH, SHELVING_LOCATION

  UNION

     SELECT statistics.branch AS CHECK_OUT_BRANCH,
          deleteditems.homebranch AS ITEM_HOMEBRANCH,
          deleteditems.location AS SHELVING_LOCATION,
          Count(*) AS ISSUES_RENEWALS  
     FROM deleteditems JOIN statistics ON deleteditems.itemnumber = statistics.itemnumber
     WHERE (statistics.datetime BETWEEN @stDate AND @edDate)
          AND (statistics.type="issue" OR statistics.type="renew")
          AND (statistics.branch LIKE @brn)
          GROUP BY CHECK_OUT_BRANCH, ITEM_HOMEBRANCH, SHELVING_LOCATION) AS COMBINED

  GROUP BY CHECK_OUT_BRANCH, ITEM_HOMEBRANCH, SHELVING_LOCATION WITH ROLLUP



